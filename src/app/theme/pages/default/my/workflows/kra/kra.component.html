

<div class="m-content" *ngIf="!param_id">
	<div class="row">
			<div class="col-xl-12">
				<div class="m-portlet m-portlet--success m-portlet--head-solid-bg m-portlet--head-sm ">
					<div class="m-portlet__head">
						<div class="m-portlet__head-caption">
							<div class="m-portlet__head-title">
								<h3 class="m-portlet__head-text">
									My KRAs
								</h3>
							</div>
						</div>
					</div>
					<div class="m-portlet__body workflow--hover">
                            <div class="row workflow--info" *ngFor="let kraworkflow of kraWorkFlowData ;let i=index;let even=even;" [ngClass]="{'workflow--info--light':!even}" >
                                    <div class="col-md-3">
                                        <div class="m-widget4">
                                            <div class="m-widget4__item">
                                                <span class="m-widget4__icon">
                                                    <i class="fa fa-circle m--font-success"></i>
                                                </span>
                                                <div class="m-widget4__info">
                                                        <span class="m-widget4__title">
                                                           {{kraworkflow.batchName}}
                                                        </span>
                                                        <br>
                                                        <span class="m-widget4__sub">
                                                            Initiated on: <strong> {{kraworkflow.createdAt | date:"dd-MMM-yyyy hh:mm aa"}}</strong>
                                                        </span>
                                                </div>
                                                <span class="m-widget4__ext">
                                                     <span class="m-widget4__number m--font-brand">
                                                     </span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="m-widget4">
                                            <div class="m-widget4__item">
                                                                <div class="m-widget4__info">
                                                                    <span class="m-widget4__title">
                                                                       Last Date : {{kraworkflow.batchEndDate | date:"dd-MMM-yyyy hh:mm"}}
                                                                    </span>
                                                                    <br>
                                                                    <span class="m-widget4__sub">
                                                                        <strong>Note-This is some static note.</strong>
                                                                    </span>
                                                                </div>
                                                                <span class="m-widget4__ext">
                                                                    <span class="m-widget4__number m--font-brand">
                                                                    </span>
                                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="m-widget4">
                                            <div class="m-widget4__item">
                                                                <div class="m-widget4__info">
                                                                    <span class="m-widget4__title">
                                                                       Status : {{kraworkflow.status}}
                                                                    </span>
                                                                    <br>
                                                                    <span class="m-widget4__sub">
                                                                        Initiated By: <strong>{{kraworkflow.createdBy}}</strong>
                                                                    </span>
                                                                </div>
                                                                <span class="m-widget4__ext">
                                                                    <span class="m-widget4__number m--font-brand">
                                                                    </span>
                                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="m-widget4">
                                            <div class="m-widget4__item">
                                                                <div class="m-widget4__info">
                                                                    <span class="btn" *ngIf="kraworkflow.status!='Terminated'" [ngClass]="kraworkflow.status=='Initiated' || kraworkflow.status=='SendBack' ? 'btn-success':'btn-secondary'">
                                                                        <a routerLink="/my/workflows/kra" [queryParams]="{ id: kraworkflow._id}">
                                                                            {{kraworkflow.status=='Initiated' || kraworkflow.status=='SendBack' ? 'Edit':'View'}}
                                                                        </a>  
                                                                    </span>
                                                                </div>
                                                                <span class="m-widget4__ext">
                                                                    <span class="m-widget4__number m--font-brand">
                                                                    </span>
                                                                </span>
                                            </div>
                                        </div>
                                    </div>
                            </div>
					</div>
				</div>	
			</div>
			
	</div>
</div>
<div class="m-content" *ngIf="param_id">
    <div class="row">
       <div class="col-md-12">
          <div class="m-portlet m-portlet--tabs m-portlet--success m-portlet--head-solid-bg m-portlet--head-sm">
             <div class="m-portlet__head">
                <div class="m-portlet__head-caption">
                   <div class="m-portlet__head-title">
                      <h3 class="m-portlet__head-text">
                         Submit KRA
                         <small>
                         </small>
                      </h3>
                   </div>
                </div> 
                <div class="m-portlet__head-tools">
                   <ul class="nav nav-tabs m-tabs m-tabs-line m-tabs-line--brand  m-tabs-line--right m-tabs-line-danger" role="tablist">
                        <!-- [attr.disabled]="kraInfoData[kraInfoData.length-1]?._id && !isDisabled ? null :'disabled'" -->
                    <li class="nav-item m-tabs__item" *ngIf="!isDisabled">
                        <button type="button" class="btn m-btn--pill pulldown btn-secondary" (click)=" fkraInfo.valid && submitKraWorkFlow()" >Submit</button>	
                    </li>
                    <li class="nav-item m-tabs__item">
                        <a class="nav-link m-tabs__link" data-toggle="tab" href="#m_tabs_9_1" role="tab" aria-selected="false" (click)="printDiv()">
                        <i class="la la-print"></i>
                        Print
                        </a>
                    </li>
                   </ul>
                </div>
             </div>
             <div class="m-portlet__body">
                <div class="m-section" >
                   <div class="m-section__content">  
                    <form #fkraInfo="ngForm" novalidate="novalidate">
                        <div class="table-responsive">
                                <table class="table table-bordered table-hover" #printKra>
                                    <thead>
                                        <tr>
                                        <th>
                                            #
                                        </th>
                                        <th>
                                            KRA
                                        </th>
                                        <th style="width: 170px;">
                                            KRA Category
                                        </th>
                                        <th>
                                            Weightage
                                        </th>
                                        <th>
                                            Unit of Success
                                        </th>
                                        <th>
                                            Measure of Success
                                        </th>
                                        <th>
                                            Supervisor
                                        </th>
                                        <th *ngIf="!isDisabled">
                                            Send Back Comment (Supervisor)
                                        </th>
                                        <th *ngIf="!isDisabled">
                                            Action
                                        </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let kraInfo of kraInfoData;let i=index" ngModelGroup="controlRow{{i}}" #controlRow="ngModelGroup" >
                                        <th scope="row">
                                                {{i+1}}
                                        </th> 
                                            <td>
                                                <textarea name="kraOne{{i}}" id="kraOne" [(ngModel)]="kraInfo.kra" #kra="ngModel" class="form-control m-input m-input--air" [disabled]="isDisabled || kraInfo.supervisorStatus=='Approved'" required></textarea>
                                            </td>
                                            <td>
                                                <ng-select class="m-input m-input--air border-danger" name="kraCategory{{i}}" id="kraCategory" [items]="kraCategoryData" bindLabel="kraCategoryName"  bindValue="_id" placeholder="Select KRA Category" [(ngModel)]="kraInfo.category_id" [clearable]="false" #kraCategory="ngModel" [disabled]="isDisabled || kraInfo.supervisorStatus=='Approved'" required></ng-select>
                                            </td>
                                            <td>
                                                <ng-select class="m-input m-input--air" name="kraWeightage{{i}}" id="kraWeightage" [items]="weightageData" bindLabel="kraWeightageName"  bindValue="_id" placeholder="Weightage" [(ngModel)]="kraInfo.weightage_id" [clearable]="false" #kraWeightage="ngModel" [disabled]="isDisabled || kraInfo.supervisorStatus=='Approved'" required></ng-select>
                                            </td>
                                            <td>
                                                <textarea name="unitOfSuccess{{i}}" id="unitOfSuccess" [(ngModel)]="kraInfo.unitOfSuccess" #unitOfSuccess="ngModel" class="form-control m-input m-input--air" [disabled]="isDisabled || kraInfo.supervisorStatus=='Approved'" required></textarea>
                                            </td>
                                            <td>
                                                <textarea name="measureOfSuccess{{i}}" id="measureOfSuccess" [(ngModel)]="kraInfo.measureOfSuccess" #measureOfSuccess="ngModel" class="form-control m-input m-input--air" [disabled]="isDisabled || kraInfo.supervisorStatus=='Approved'" required></textarea>
                                            </td>
                                            <td>
                                                <ng-select class="m-input m-input--air" name="supervisor{{i}}" id="supervisor" [items]="supervisorData" bindLabel="fullName"  bindValue="_id" placeholder="Select Supervisor" [(ngModel)]="kraInfo.supervisor_id" [clearable]="false" #supervisorOne="ngModel" [disabled]="isDisabled || kraInfo.supervisorStatus=='Approved'" required></ng-select>
                                            </td>
                                            <td *ngIf="!isDisabled">
                                                <textarea name="sendBackComment{{i}}" id="sendBackComment" #sendBackComment="ngModel" [(ngModel)]="kraInfo.sendBackComment" class="form-control m-input m-input--air" disabled></textarea>
                                            </td>
                                            <td *ngIf="!isDisabled">
                                                    <!-- (isDisabled || kraInfo.supervisorStatus=='Approved') &&  -->
                                               <button type="button" class="m-portlet__nav-link btn m-btn m-btn--hover-success m-btn--icon m-btn--icon-only m-btn--pill"  title="Save" *ngIf="kraInfo.supervisorStatus!='Approved'" (click)="saveKraDetails(i,controlRow)" [disabled]="!controlRow.valid">
                                                <i class="la la-save"></i>
                                               </button>
                                               <button type="button" class="m-portlet__nav-link btn m-btn m-btn--hover-danger m-btn--icon m-btn--icon-only m-btn--pill"  title="Delete" *ngIf="kraInfo.supervisorStatus!='Approved'" (click)="deleteKraHtml(i)" [disabled]="isDisabled || kraInfo.supervisorStatus=='Approved'">
                                                    <i class="la la-remove"></i>
                                               </button>
                                               <!-- <button *ngIf="kraInfo.supervisorStatus!='Approved' "  type="button" (click)="saveKraDetails(i)" class="btn btn-success m-btn m-btn--icon m-btn--icon-only m-btn--custom m-btn--pill m-btn--air" [disabled]="isDisabled || kraInfo.supervisorStatus=='Approved'"> <i class="fa fa-save"></i></button>
                                               <button *ngIf="kraInfo.supervisorStatus!='Approved'" type="button" (click)="deleteKraHtml(i)" class="btn btn-success m-btn m-btn--icon m-btn--icon-only m-btn--custom m-btn--pill m-btn--air" [disabled]="isDisabled || kraInfo.supervisorStatus=='Approved' "> <i class="fa fa-remove"></i></button> -->
                                            </td>
                                        </tr>
                                        <tr *ngIf="!isDisabled">
                                            <td colspan="9">
                                               <button class="btn btn-success m-btn m-btn--icon m-btn--icon-only m-btn--custom m-btn--pill m-btn--air pull-right" [attr.disabled]="kraInfoData[kraInfoData.length-1]?._id && !isDisabled ? null :'disabled'" (click)="addKraHtml()"><i class="la la-plus "></i></button>
                                            </td>
                                       </tr>
                                    </tbody>
                                </table>
                        </div>
                        <br>
                        <!-- [attr.disabled]="kraInfoData[kraInfoData.length-1]?._id && !isDisabled ? null :'disabled'" -->
                        <!-- <button class="btn btn-success m-btn--air" type="submit">
                           Submit
                        </button> -->
                    </form>
                   </div><br><br>
                   <div class="row m-portlet__body m-portlet m-portlet--tabs  m-portlet--head-solid-bg m-portlet--bordered" *ngIf="isKraAvaliable">
                        <div class="tab-content">
                            <div class="m-widget3">
                                <div class="m-widget3__item">
                                    <div class="m-widget3__header">
                                        <div class="m-widget3__user-img">
                                            <img class="m-widget3__img" src="./assets/app/media/img/users/user6.jpg" alt="">
                                        </div>
                                        <div class="m-widget3__info">
                                            <span class="m-widget3__username" id="hrName">
                                                Test HR
                                            </span>
                                            <br>
                                            <span class="m-widget3__time" id="dateTime">
                                                2 day ago
                                            </span>
                                        </div>
                                        <span class="m-badge m-badge--success m-badge--wide" id="kraStatus">
                                            accepted
                                        </span>
                                    </div>
                                    <div class="m-widget3__body">
                                        <p class="m-widget3__text m--font-success" id="kraTimeline">
                                            Your KRA has been Accepted.
                                        </p>
                                    </div>
                                </div>
                                <div class="m-widget3__item">
                                    <div class="m-widget3__header">
                                        <div class="m-widget3__user-img">
                                            <img class="m-widget3__img" src="./assets/app/media/img/users/user6.jpg" alt="">
                                        </div>
                                        <div class="m-widget3__info">
                                            <span class="m-widget3__username" id="supervisorName">
                                                Test Supervisor
                                            </span>
                                            <br>
                                            <span class="m-widget3__time">
                                                1 weeks ago
                                            </span>
                                        </div>
                                        <span class="m-badge m-badge--info m-badge--wide">
                                            initiated
                                        </span>
                                    </div>
                                    <div class="m-widget3__body">
                                        <p class="m-widget3__text m--font-info" >
                                            Your KRA has been Initiated.
                                        </p>
                                    </div>
                                </div>
                                <div class="m-widget3__item">
                                    <div class="m-widget3__header">
                                        <div class="m-widget3__user-img">
                                            <img class="m-widget3__img" src="./assets/app/media/img/users/user6.jpg" alt="">
                                        </div>
                                        <div class="m-widget3__info">
                                            <span class="m-widget3__username" id="hrName">
                                                Test HR
                                            </span>
                                            <br>
                                            <span class="m-widget3__time">
                                               2 weeks ago
                                            </span>
                                        </div>
                                        <span class="m-badge m-badge--danger m-badge--wide">
                                            rejected
                                        </span>
                                    </div>
                                    <div class="m-widget3__body">
                                        <p class="m-widget3__text m--font-danger">
                                            Your KRA has been rejected.
                                        </p>
                                    </div>
                                </div>
                                <div class="m-widget3__item">
                                    <div class="m-widget3__header">
                                        <div class="m-widget3__user-img">
                                            <img class="m-widget3__img" src="./assets/app/media/img/users/user6.jpg" alt="">
                                        </div>
                                        <div class="m-widget3__info">
                                            <span class="m-widget3__username" id="supervisorName">
                                                Test Supervisor
                                            </span>
                                            <br>
                                            <span class="m-widget3__time">
                                                3 weeks ago
                                            </span>
                                        </div>
                                        <span class="m-badge m-badge--info m-badge--wide">
                                            initiated
                                        </span>
                                    </div>
                                    <div class="m-widget3__body">
                                        <p class="m-widget3__text m--font-info">
                                            Your KRA has been Initiated.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
             </div>
          </div>
       </div>
    </div>
</div>

