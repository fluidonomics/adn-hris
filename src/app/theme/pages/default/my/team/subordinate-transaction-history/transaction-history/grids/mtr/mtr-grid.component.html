<div class="m-datatable m-datatable--default m-datatable--brand m-datatable--loaded m-datatable--error">
    <table class="m-datatable__table">
        <thead class="m-datatable__head">
            <tr class="m-datatable__row">
                <th class="m-datatable__cell m-datatable__cell--sort" width="5%">
                    #
                </th>
                <th class="m-datatable__cell m-datatable__cell--sort" width="35%">
                    KRA
                </th>
                <th class="m-datatable__cell m-datatable__cell--sort" width="30%">
                    KRA Category
                </th>
                <th class="m-datatable__cell m-datatable__cell--sort" width="10%">
                    Weightage
                </th>
                <!-- <th class="m-datatable__cell m-datatable__cell--sort" width="10%">
                    Employee Remarks
                </th> -->
                <th class="m-datatable__cell m-datatable__cell--sort" width="15%">
                    Status
                </th>
                <th class="m-datatable__cell m-datatable__cell--sort" width="5%">
                    Action
                </th>
            </tr>
        </thead>
        <tbody class="m-datatable__body">
            <tr class="m-datatable__row" *ngFor="let mtrInfo of mtrDetails;let i=index" [ngClass]="{
                     'newKRA':mtrDetails[i].status == 'Submitted' && !mtrDetails[i].kraDetailId,
                     'dropped':mtrDetails[i].status == 'Dropped' || mtrDetails[i].progressStatus == 'Dropped',
                     'approved':mtrDetails[i].status == 'Approved',
                     'sendBack':mtrDetails[i].status == 'SendBack'
                    }">
                <td scope="row" class="m-datatable__cell" width="5%">
                    {{i+1}}
                </td>
                <td class="m-datatable__cell" width="35%">
                    <textarea name="mtrOne" [(ngModel)]="mtrInfo.mtr_kra" #mtr="ngModel" class="form-control m-input m-input--air" disabled></textarea>
                </td>
                <td class="m-datatable__cell" width="30%">
                    <ng-select class="m-input m-input--air" name="mtrCategory" id="kraCategory" [items]="kraCategoryData" bindLabel="kraCategoryName"
                        bindValue="_id" placeholder="Select KRA Category" [(ngModel)]="mtrInfo.category_id" [clearable]="false"
                        #kraCategory="ngModel" disabled></ng-select>
                </td>
                <td class="m-datatable__cell" width="10%">
                    <ng-select class="m-input m-input--air" name="mtrWeightage" id="mtrWeightage" [items]="weightageData" bindLabel="kraWeightageName"
                        bindValue="_id" [placeholder]="mtrInfo.progressStatus =='Dropped'? 'Dropped': 'Weightage'" [(ngModel)]="mtrInfo.weightage_id"
                        [clearable]="false" #mtrWeightage="ngModel" disabled></ng-select>
                </td>
                <!-- <td class="m-datatable__cell" width="10%">
                    <textarea name="employeeComment" [(ngModel)]="mtrInfo.employeeComment" #employeeComment="ngModel" class="form-control m-input m-input--air"
                        disabled></textarea>
                </td> -->
                <td class="gridColorStatus m-datatable__cell" width="15%">
                    <i *ngIf="mtrInfo.kraDetailId" class="fa fa-circle" [ngClass]="mtrInfo.colorStatus"></i>
                    <span>{{mtrInfo.progressStatus}}</span>
                </td>
                <td class="m-datatable__cell" width="5%">
                    <span>
                            <a href="#" class="m-portlet__nav-link btn m-btn m-btn--hover-success m-btn--icon m-btn--icon-only m-btn--pill"
                                title="Mid Term Review Detail" (click)="showMtrDetail(i, $event)">
                                <i class="la la-info"></i>
                            </a>
                        </span>
                </td>
            </tr>
        </tbody>
    </table>
</div>


<ng-template #mtrDetailModal>
    <div class="m-portlet m-portlet--warning m-portlet--head-solid-bg m-portlet--head-sm  m-portlet--full-height mtrDetailsPortlet">
        <div class="m-portlet__head">
            <div class="m-portlet__head-caption">
                <div class="m-portlet__head-title">
                    <h3 class="m-portlet__head-text">
                        Key Responsibility Area
                    </h3>
                </div>
            </div>
            <div class="m-portlet__head-tools">
                <ul class="m-portlet__nav">
                    <li class="m-portlet__nav-item">
                        <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
                            <div class="btn-group" role="group">
                                <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="m-portlet__body">
            <div class="m-widget6 ">
                <div class="row">
                    <div class="col-md-6">
                        <span>Mid Term Review No. {{mtrData.no}}</span>
                    </div>
                    <div class="col-md-6">
                        <div class="row">
                            <div class="col-md-9">
                                <span class="block"> {{user?.fullName}} ({{user?.userName}})</span>
                                <span class="block"> {{user?.designationDetails?.designationName}}</span>
                            </div>
                            <div class="col-md-3">
                                <img class="img" *ngIf="user.profileImage;" src="{{imageBase+user.profileImage}}" onerror="this.src ='./assets/app/media/img/custom/users/user6.jpg';">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row details">
                    <div class="col-md-6 form-group flex">
                        <span class="key">Category</span>
                        <span class="value">{{mtrData?.category?.kraCategoryName}}</span>
                    </div>
                    <div class="col-md-6 form-group flex">
                        <span class="key">Weightage</span>
                        <span class="value">{{mtrData?.weightage?.kraWeightageName}}</span>
                    </div>
                    <div class="col-md-12 form-group">
                        <span class="key">Key Responsibility Area</span>
                        <textarea class="form-control m-input m-input--air" rows="3" value="{{mtrData?.mtr_kra}}" disabled="true"></textarea>
                    </div>

                    <div class="col-md-6 form-group">
                        <span class="key">Unit Of Success</span>
                        <textarea class="form-control m-input m-input--air" rows="3" value="{{mtrData?.unitOfSuccess}}" disabled="true"></textarea>
                    </div>
                    <div class="col-md-6 form-group">
                        <span class="key">Measure Of Success</span>
                        <textarea class="form-control m-input m-input--air" rows="3" value="{{mtrData?.measureOfSuccess}}" disabled="true"></textarea>
                    </div>
                    <div class="col-md-6 form-group">
                        <span class="key">Status</span>
                        <span class="value">{{mtrData?.progressStatus}}</span>
                    </div>
                    <div class="col-md-6 form-group colorStatus" *ngIf="mtrData.kraDetailId">
                        <span class="key">Color Status</span>
                        <span class="value" [ngClass]="mtrData.colorStatus"><i class="fa fa-square"></i></span>
                    </div>
                    <div class="col-md-12 form-group">
                        <span class="key">Employee Remarks</span>
                        <textarea class="form-control m-input m-input--air" rows="3" [(ngModel)]="mtrData.employeeComment" disabled></textarea>
                    </div>
                    <div class="col-md-12 form-group">
                        <span class="key">Supervisor Remarks</span>
                        <textarea class="form-control m-input m-input--air" rows="3" [(ngModel)]="mtrData.supervisorComment" disabled></textarea>
                    </div>
                </div>
                <div class="form-actions">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="m-form__actions">
                                <button class="btn btn-secondary" (click)="modalRef.hide()">Back</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-template>