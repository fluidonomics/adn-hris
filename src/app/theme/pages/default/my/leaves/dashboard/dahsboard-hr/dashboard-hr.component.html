<div class="m-content">
    <div class="row">
        <div class="col-xl-6">
            <div class="m-portlet m-portlet--warning m-portlet--head-solid-bg m-portlet--head-sm m-portlet--full-height">
                <div class="m-portlet__head">
                    <div class="m-portlet__head-caption">
                        <div class="m-portlet__head-title">
                            <span class="m-portlet__head-icon m--hide">
                                <i class="la la-gear"></i>
                            </span>
                            <h3 class="m-portlet__head-text">
                                Leave Availed Percentage
                            </h3>
                        </div>
                    </div>
                    <div class="m-portlet__head-tools">
                        <ul class="m-portlet__nav">
                            <li class="m-portlet__nav-item">
                                <input class="form-control" #drp="bsDaterangepicker" bsDaterangepicker [bsConfig]="{ dateInputFormat: 'DD MMM' }" [(ngModel)]="overviewChartDataFilter.date"
                                    (ngModelChange)="getOverviewChartData()" placeholder="Select Month" placement="bottom" readonly>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="m-portlet__body">
                    <app-my-leaves-chart-monthly-leave [chartData]="overviewChartData"></app-my-leaves-chart-monthly-leave>
                </div>
            </div>
        </div>
        <div class="col-xl-6">
            <div class="m-portlet m-portlet--warning m-portlet--head-solid-bg m-portlet--head-sm m-portlet--full-height">
                <div class="m-portlet__head">
                    <div class="m-portlet__head-caption">
                        <div class="m-portlet__head-title">
                            <span class="m-portlet__head-icon m--hide">
                                <i class="la la-gear"></i>
                            </span>
                            <h3 class="m-portlet__head-text">
                                Approved Status Percentage
                            </h3>
                        </div>
                    </div>
                    <div class="m-portlet__head-tools">
                        <ul class="m-portlet__nav">
                            <li class="m-portlet__nav-item">
                                <input class="form-control" #drp="bsDaterangepicker" bsDaterangepicker [bsConfig]="{ dateInputFormat: 'DD MMM' }" [(ngModel)]="overviewChartDataFilter.date"
                                    (ngModelChange)="getOverviewChartData()" placeholder="Select Month" placement="bottom" readonly>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="m-portlet__body">
                    <app-my-leaves-chart-monthly-leave [chartData]="overviewChartData"></app-my-leaves-chart-monthly-leave>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xl-12">
            <div class="m-portlet m-portlet--warning m-portlet--head-solid-bg m-portlet--head-sm recentTransactionPortlet">
                <div class="m-portlet__head">
                    <div class="m-portlet__head-caption">
                        <div class="m-portlet__head-title">
                            <h3 class="m-portlet__head-text">
                                Employee On Leave
                            </h3>
                        </div>
                    </div>
                    <div class="m-portlet__head-tools">
                        <ul class="nav nav-tabs m-tabs m-tabs-line m-tabs-line--brand  m-tabs-line--right m-tabs-line-danger" role="tablist">
                            <li class="nav-item m-tabs__item">
                                <input class="form-control" #drp="bsDaterangepicker" bsDaterangepicker [bsConfig]="{ dateInputFormat: 'DD MMM' }" [(ngModel)]="leaveApprovalFilter.date"
                                    (ngModelChange)="getTeamLeavesForApproval()" placeholder="Select Month" placement="left"
                                    readonly>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="m-portlet__body">
                    <!--begin::Section-->
                    <div class="m-accordion m-accordion--default m-accordion--toggle-arrow" id="m_accordion_5" role="tablist">
                        <!--begin::Item-->
                        <div class="m-accordion__item m-accordion__item--green">
                            <div class="m-accordion__item-head collapsed" srole="tab" id="m_accordion_5_item_1_head" data-toggle="collapse" href="#m_accordion_5_item_1_body"
                                aria-expanded="true">
                                <span class="m-accordion__item-title">
                                </span>
                                <span class="m-accordion__item-mode"></span>
                            </div>
                            <div class="m-accordion__item-body collapse show" id="m_accordion_5_item_1_body">
                                <div class="m-accordion__item-content">
                                    <div class="m-datatable m-datatable--default m-datatable--brand m-datatable--loaded">
                                        <table class="m-datatable__table">
                                            <thead class="m-datatable__head">
                                                <tr class="m-datatable__row">
                                                    <th class="m-datatable__cell m-datatable__cell--sort">
                                                        <span>Pic</span>
                                                    </th>
                                                    <th class="m-datatable__cell m-datatable__cell--sort">
                                                        <span>Name</span>
                                                    </th>
                                                    <th class="m-datatable__cell m-datatable__cell--sort">
                                                        <span>Gender</span>
                                                    </th>
                                                    <th class="m-datatable__cell m-datatable__cell--sort">
                                                        <span>Department</span>
                                                    </th>
                                                    <th class="m-datatable__cell m-datatable__cell--sort">
                                                        <span>From</span>
                                                    </th>
                                                    <th class="m-datatable__cell m-datatable__cell--sort text-center">
                                                        <span>To</span>
                                                    </th>
                                                    <th class="m-datatable__cell m-datatable__cell--sort">
                                                        <span>Days</span>
                                                    </th>
                                                    <th class="m-datatable__cell m-datatable__cell--sort">
                                                        <span>Leave Type</span>
                                                    </th>
                                                    <th class="m-datatable__cell m-datatable__cell--sort">
                                                        <span>Supervisor</span>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody class="m-datatable__body">
                                                <tr (click)="showLeaveDetail(leave.leavedetails._id, leaveDetailModal)" class="m-datatable__row" *ngFor="let leave of leavesForApproval">
                                                    <td class="m-datatable__cell">
                                                        <span>{{leave.employeeDetails?.fullName}}</span>
                                                    </td>
                                                    <td class="m-datatable__cell">
                                                        <span>{{leave.employeeDetails?.userName}}</span>
                                                    </td>
                                                    <td class="m-datatable__cell">
                                                        <span>{{leave.leaveTypeName}}</span>
                                                    </td>
                                                    <td class="m-datatable__cell">
                                                        <span>{{leave.leavedetails?.fromDate | date:'dd MMM yyy'}}</span>
                                                    </td>
                                                    <td class="m-datatable__cell">
                                                        <span>{{leave.leavedetails?.toDate | date:'dd MMM yyy'}}</span>
                                                    </td>
                                                    <td class="m-datatable__cell text-center">
                                                        <span>{{leave.leavedetails?.days}}</span>
                                                    </td>
                                                    <td class="m-datatable__cell">
                                                        <span>{{leave.leavedetails?.createdAt | date:'dd MMM yyy'}}</span>
                                                    </td>
                                                    <td class="m-datatable__cell">
                                                        <span>{{leave.leavedetails?.createdByName?.fullName}}</span>
                                                    </td>
                                                    <td class="m-datatable__cell">
                                                        <span>{{leave.leavedetails?.updatedAt | date:'dd MMM yyy'}}</span>
                                                    </td>
                                                    <td class="m-datatable__cell">
                                                        <span>{{leave.leavedetails?.updatedByName?.fullName}}</span>
                                                    </td>
                                                    <td class="m-datatable__cell">
                                                        <span class="m-badge m-badge--success m-badge--wide">{{leave.leavedetails?.status}}</span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--end::Item-->
                    </div>
                    <!--end::Section-->
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-xl-12">
            <div class="m-portlet m-portlet--warning m-portlet--head-solid-bg m-portlet--head-sm teamLeavesPortlet">
                <div class="m-portlet__head">
                    <div class="m-portlet__head-caption">
                        <div class="m-portlet__head-title">
                            <h3 class="m-portlet__head-text">
                                Leave Transactions Report
                            </h3>
                        </div>
                    </div>
                </div>
                <div class="m-portlet__body">
                    <div class="form-body">
                        <div class="row">
                            <div class="col-md-6 adn-form__group">
                                <div class="m-form__group form-group">
                                    <!-- <label for="form_control_1">Leave Type</label>
                                    <span class="required" aria-required="true"> * </span>
                                    <ng-select #ddLeaveType class="m-input m-input--air" name="leaveType" bindValue="_id" bindLabel="type" [items]="leaveTypesDetails"
                                        [(ngModel)]="leaveapplication.leaveType" id="leavetype" #leavetype="ngModel" placeholder="Select Leave Type"
                                        (ngModelChange)="onChangeLeaveType()" [clearable]="false" required></ng-select>
                                    <div class="form-control-feedback has-danger" *ngIf="fleaveapplication.submitted && !leavetype.valid">
                                        This field is required.
                                    </div> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<ng-template #leaveDetailModal>
    <div class="m-portlet m-portlet--warning m-portlet--head-solid-bg m-portlet--head-sm  m-portlet--full-height leaveDetailsPortlet">
        <div class="m-portlet__head">
            <div class="m-portlet__head-caption">
                <div class="m-portlet__head-title">
                    <h3 class="m-portlet__head-text">
                        Leave Details
                    </h3>
                </div>
            </div>
            <div class="m-portlet__head-tools">
                <ul class="m-portlet__nav">
                    <li class="m-portlet__nav-item">
                        <div class="btn-group" role="group" aria-label="Button group with nested dropdown">
                            <div class="btn-group" role="group">
                                <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="m-portlet__body">
            <div class="m-widget6 ">
                <div class="row">
                    <div class="col-md-3">
                        <img class="img" src="./assets/app/media/img/custom/users/user6.jpg">
                    </div>
                    <div class="col-md-9">
                        <span class="name">
                            {{leaveDetails?.leave?.emp_name?.fullName}}
                        </span>
                        <span class="empId">
                            ({{leaveDetails?.leave?.emp_name?.userName}})
                        </span>
                    </div>
                </div>
                <div class="row details">
                    <div class="col-md-12 form-group">
                        <span class="key">Leave Type</span>
                        <span class="value">{{leaveDetails?.leave?.leaveTypes?.type}}</span>
                    </div>
                    <div class="col-md-6 form-group">
                        <span class="key">From Date</span>
                        <span class="value">{{leaveDetails?.leave?.fromDate | date: 'dd MMM yyy'}}</span>
                    </div>
                    <div class="col-md-6 form-group">
                        <span class="key">To Date</span>
                        <span class="value">{{leaveDetails?.leave?.toDate | date: 'dd MMM yyy'}}</span>
                    </div>
                    <div class="col-md-6 form-group">
                        <span class="key">Applied On</span>
                        <span class="value">{{leaveDetails?.leave?.createdAt | date: 'dd MMM yyy'}}</span>
                    </div>
                    <div class="col-md-6 form-group">
                        <span class="key">Status</span>
                        <span class="value">{{leaveDetails?.leave?.status}}</span>
                    </div>
                    <div class="col-md-6 form-group">
                        <span class="key">Days</span>
                        <span class="value">{{leaveDetails?.leave?.days}}</span>
                    </div>
                    <div class="col-md-6 form-group">
                        <span class="key">Leave Balance</span>
                        <span class="value"></span>
                    </div>
                    <div class="col-md-12 form-group">
                        <span class="key">Apporval Authority</span>
                        <span class="value"></span>
                    </div>
                    <div class="col-md-12 adn-form__group">
                        <div class="m-form__group form-group">
                            <label for="form_control_1">Reason</label>
                            <textarea name="reason" id="reason" class="form-control m-input m-input--air" rows="3" value="{{leaveDetails?.leave?.reason}}"
                                disabled="true"></textarea>
                        </div>
                    </div>
                    <div class="col-md-12 adn-form__group">
                        <div class="m-form__group form-group">
                            <label for="form_control_1">Remarks</label>
                            <textarea name="reason" id="remarks" class="form-control m-input m-input--air" rows="3" placeholder="Remarks" [(ngModel)]="leaveDetails.remarks"
                                #remarks="ngModel"></textarea>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="m-form__actions">
                                <button class="btn btn-success" (click)="approveRejectLeave($event, leaveDetails.leave._id, leaveDetails.leave.status, 'Approved', leaveDetails.remarks)">Approve Leave</button>
                                <button class="btn btn-success" (click)="approveRejectLeave($event, leaveDetails.leave._id, leaveDetails.leave.status, 'Reject', leaveDetails.remarks)">Reject Leave</button>
                                <button class="btn btn-secondary " (click)="modalRef.hide() " type="button ">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-template>